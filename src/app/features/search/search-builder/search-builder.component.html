<div class="card rounded-bottom-0 rounded-end-0 bg-success text-white text-center fw-bold py-1">
    Selecão de Atributos
</div>
<div class="d-flex flex-column p-2">
    <div class="row d-flex align-items-center">
        <div class="col-auto d-flex align-items-center">
            <label class="form-label mb-0 me-1" for="itemFamily">Família:</label>
        </div>
        <div class="col d-flex align-items-center">
            <select class="form-select form-select-sm w-auto" name="itemFamily" id="itemFamily"
                (change)="onActiveFamilyChange($event)">
                <option value="" hidden>Escolha uma família</option>
                @for (family of itemFamilies(); track $index){
                <option value={{family.id}}>{{family.name}} - {{family.description}}</option>
                }
            </select>
        </div>
        <div class="col d-flex align-items-center">
            <button class="btn btn-secondary btn-sm ms-auto" (click)="onSearchClicked()">
                <i class="fa-solid fa-magnifying-glass me-1"></i>
                <span>Pesquisar</span>
            </button>
        </div>
    </div>
    <hr class="my-2">
    @if (!activeItemFamily()) {
        <small class="text-center text-black-50">Nenhuma família escolhida</small>
    }
    <form [formGroup]="attributesForm">
        <table class="table table-borderless table-sm">
            <colgroup>
                <col span="1" class="w-auto">
                <col span="1" class="w-auto">
                <col span="1" class="w-100">
            </colgroup>
            <tbody class="">
                @for (attribute of activeFamilyAttributes(); track $index){
                <tr [formGroupName]="attribute.id">
                    <td class="text-end align-middle">
                        <label class="form-label fs-6 mb-0 me-1"
                            for="{{attribute.id}}Value"><small>{{attribute.name}}:</small></label>
                    </td>
                    <td>
                        <select class="operator-select form-select form-select-sm w-auto ms-auto me-1"
                            name="{{attribute.id}}Operator" id="{{attribute.id}}Operator"
                            formControlName="operator">
                            <option value="=">=</option>
                            @if (attribute.type == "typeNumber"){
                            <option value=">">></option>
                            <option value="<"><</option>
                                    }
                        </select>
                    </td>
                    <td>
                        @if (attribute.type == "typeSelect"){
                        <select class="form-select form-select-sm w-100" id="{{attribute.id}}Value"
                            formControlName="value">
                            @for(option of attribute.options; track $index){
                            <option value="{{option.name}}">{{option.name}}</option>
                            }
                        </select>
                        }
                        @else if (attribute.type == "typeYesNo") {
                        <select class="form-select form-select-sm w-100" id="{{attribute.id}}Value"
                            formControlName="value">
                            <option value="NAO">NAO</option>
                            <option value="SIM">SIM</option>
                        </select>
                        }
                        @else if(attribute.type == "typeNumber"){
                        <input class="form-control form-control-sm w-100" type="number" id="{{attribute.id}}Value"
                            formControlName="value">
                        }
                        @else{
                        <input class="form-control form-control-sm w-100" type="text" id="{{attribute.id}}Value"
                            formControlName="value">
                        }
                    </td>
                    }
            </tbody>
        </table>
    </form>
</div>